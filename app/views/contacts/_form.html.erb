<%= form_with model: @contact, html: { class: 'card p-3' } do |f| %>
  <div class="row g-3">
    <!-- Hidden company_id field -->
    <%= f.hidden_field :company_id %>

    <!-- Show company name if coming from company context -->
    <% if @company.present? %>
      <div class="col-12">
        <div class="alert alert-info">
          <strong>Creating contact for:</strong> <%= @company.name %>
        </div>
      </div>
      <div class="col-12">
        <label class="form-label">Company</label>
        <input type="text" class="form-control" value="<%= @company.name %>" readonly>
      </div>
    <% end %>

    <div class="col-md-6">
      <%= f.label :customer_name, class: 'form-label' %>
      <%= f.text_field :customer_name, class: 'form-control', required: true %>
    </div>
    <div class="col-md-6">
      <%= f.label :email, class: 'form-label' %>
      <%= f.email_field :email, class: 'form-control', required: true %>
    </div>
    <div class="col-md-6">
      <%= f.label :phone, class: 'form-label' %>
      <%= f.text_field :phone, class: 'form-control' %>
    </div>

    <!-- Only show user_id field if not coming from company context -->
    <% unless @company.present? %>
      <div class="col-md-6">
        <%= f.label :user_id, class: 'form-label' %>
        <%= f.hidden_field :user_id %>
        <input type="text" class="form-control" value="<%= @contact.user&.name || current_user&.name || 'Unknown' %>" readonly>
      </div>
    <% end %>
  </div>

  <div class="mt-3 d-flex justify-content-between">
    <%= f.submit 'Save Contact', class: 'btn btn-primary' %>
    <% if @company.present? %>
      <%= link_to 'Cancel', company_path(@company), class: 'btn btn-secondary' %>
    <% else %>
      <%= link_to 'Cancel', contacts_path, class: 'btn btn-secondary' %>
    <% end %>
  </div>
<% end %>
